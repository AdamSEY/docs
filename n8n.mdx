---
title: "n8n Integration"
description: "Automate email generation with Migma and n8n - No code required"
---

## Overview

Automate your email workflows using Migma and [n8n](https://n8n.io). Import brands from websites and generate AI-powered emails using simple drag-and-drop nodes.

<Info>
  **What is n8n?** An open-source workflow automation tool with a visual interface. Perfect for connecting APIs without writing code.
</Info>

## Quick Setup

<Steps>
  <Step title="Get Your API Key">
    Go to [Migma Settings → API Integration](https://migma.ai/settings) and create an API key
  </Step>
  <Step title="Add Credentials in n8n">
    In n8n: **Settings → Credentials → Add Credential → Http Bearer Auth**
    
    Paste your API key and name it "Migma API"
  </Step>
</Steps>

## Key Endpoints

All endpoints use `https://api.migma.ai` as the base URL.

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/v1/projects/import` | POST | Import a brand from website URL |
| `/v1/projects/import/{projectId}/status` | GET | Check import status |
| `/v1/projects/{projectId}` | GET | Get project details |
| `/v1/projects/emails/generate` | POST | Generate an email |
| `/v1/projects/emails/{conversationId}/status` | GET | Check generation status |
| `/v1/export/html/{conversationId}` | GET | Export as HTML |
| `/v1/emails/test/send` | POST | Send test email |

<Card title="Full API Reference" icon="book" href="/api-reference/introduction">
  View complete documentation with all parameters and responses
</Card>

## Copy-Paste Workflows

### 1. Import a Brand

Import brand assets from a website URL.

<Accordion title="Import Brand Workflow JSON">
```json
{
  "name": "Migma: Import Brand",
  "nodes": [
    {
      "parameters": {},
      "id": "manual-trigger",
      "name": "Start",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.migma.ai/v1/projects/import",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"urls\": [\"https://yourwebsite.com\"]}",
        "options": {}
      },
      "id": "import-brand",
      "name": "Import Brand",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [450, 300],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    }
  ],
  "connections": {
    "Start": {
      "main": [[{ "node": "Import Brand", "type": "main", "index": 0 }]]
    }
  }
}
```
</Accordion>

**What you get back:**
- `projectId`: Use this to check status
- `status`: Will be "pending" initially
- `domain`: Extracted domain name

### 2. Generate an Email

Generate an AI-powered email for a project.

<Accordion title="Generate Email Workflow JSON">
```json
{
  "name": "Migma: Generate Email",
  "nodes": [
    {
      "parameters": {},
      "id": "manual-trigger",
      "name": "Start",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.migma.ai/v1/projects/emails/generate",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"projectId\": \"YOUR_PROJECT_ID\", \"prompt\": \"Create a welcome email for new subscribers\"}",
        "options": {}
      },
      "id": "generate-email",
      "name": "Generate Email",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [450, 300],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    }
  ],
  "connections": {
    "Start": {
      "main": [[{ "node": "Generate Email", "type": "main", "index": 0 }]]
    }
  }
}
```
</Accordion>

**What you get back:**
- `conversationId`: Use this to check status and export
- `status`: Will be "pending" initially
- `link`: Direct link to view in Migma dashboard

### 3. Export as HTML

Export the generated email as HTML.

<Accordion title="Export HTML Workflow JSON">
```json
{
  "name": "Migma: Export HTML",
  "nodes": [
    {
      "parameters": {},
      "id": "manual-trigger",
      "name": "Start",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=https://api.migma.ai/v1/export/html/YOUR_CONVERSATION_ID",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "options": {}
      },
      "id": "export-html",
      "name": "Export HTML",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [450, 300],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    }
  ],
  "connections": {
    "Start": {
      "main": [[{ "node": "Export HTML", "type": "main", "index": 0 }]]
    }
  }
}
```
</Accordion>

**What you get back:**
- `files[0].content`: Full HTML content as string
- `files[0].url`: Download URL (valid for 24 hours)
- `files[0].fileSize`: Size in bytes

<Tip>
  Replace `YOUR_CREDENTIAL_ID`, `YOUR_PROJECT_ID`, and `YOUR_CONVERSATION_ID` with your actual values, or use n8n expressions like `{{ $json.data.projectId }}` to pass data between nodes.
</Tip>

## Complete Workflow

Here's a full workflow that imports a brand, waits for completion, generates an email, and exports it:

<Accordion title="Complete Workflow JSON">
```json
{
  "name": "Migma: Complete Workflow",
  "nodes": [
    {
      "parameters": {},
      "id": "start",
      "name": "Start",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.migma.ai/v1/projects/import",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"urls\": [\"https://yourwebsite.com\"]}",
        "options": {}
      },
      "id": "import",
      "name": "Import Brand",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [450, 300],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    },
    {
      "parameters": {
        "amount": 10,
        "unit": "seconds"
      },
      "id": "wait-import",
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1,
      "position": [650, 300],
      "webhookId": "wait-webhook-1"
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=https://api.migma.ai/v1/projects/import/{{ $json.data.projectId }}/status",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "options": {}
      },
      "id": "check-import",
      "name": "Check Import Status",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [850, 300],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.data.status }}",
              "operation": "equals",
              "value2": "active"
            }
          ]
        }
      },
      "id": "is-complete",
      "name": "Is Complete?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1050, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.migma.ai/v1/projects/emails/generate",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"projectId\": \"{{ $json.data.projectId }}\", \"prompt\": \"Create a welcome email\"}",
        "options": {}
      },
      "id": "generate",
      "name": "Generate Email",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1250, 200],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    },
    {
      "parameters": {
        "amount": 5,
        "unit": "seconds"
      },
      "id": "wait-generate",
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1,
      "position": [1450, 200],
      "webhookId": "wait-webhook-2"
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=https://api.migma.ai/v1/projects/emails/{{ $json.data.conversationId }}/status",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "options": {}
      },
      "id": "check-generate",
      "name": "Check Generation Status",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1650, 200],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.data.status }}",
              "operation": "equals",
              "value2": "completed"
            }
          ]
        }
      },
      "id": "is-generated",
      "name": "Is Generated?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1850, 200]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=https://api.migma.ai/v1/export/html/{{ $json.data.conversationId }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "options": {}
      },
      "id": "export",
      "name": "Export HTML",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [2050, 100],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    }
  ],
  "connections": {
    "Start": {
      "main": [[{ "node": "Import Brand", "type": "main", "index": 0 }]]
    },
    "Import Brand": {
      "main": [[{ "node": "Wait", "type": "main", "index": 0 }]]
    },
    "Wait": {
      "main": [[{ "node": "Check Import Status", "type": "main", "index": 0 }]]
    },
    "Check Import Status": {
      "main": [[{ "node": "Is Complete?", "type": "main", "index": 0 }]]
    },
    "Is Complete?": {
      "main": [
        [{ "node": "Generate Email", "type": "main", "index": 0 }],
        [{ "node": "Wait", "type": "main", "index": 0 }]
      ]
    },
    "Generate Email": {
      "main": [[{ "node": "Wait", "type": "main", "index": 0 }]]
    },
    "Check Generation Status": {
      "main": [[{ "node": "Is Generated?", "type": "main", "index": 0 }]]
    },
    "Is Generated?": {
      "main": [
        [{ "node": "Export HTML", "type": "main", "index": 0 }],
        [{ "node": "Wait", "type": "main", "index": 0 }]
      ]
    }
  }
}
```
</Accordion>

This workflow:
1. Imports a brand
2. Waits and checks if import is complete (loops until done)
3. Generates an email
4. Waits and checks if generation is complete (loops until done)
5. Exports the final HTML

## Advanced Use Cases

### Shopify Multi-Store Automation

For processing multiple Shopify stores from a spreadsheet, see this advanced workflow:

<Steps>
  <Step title="Prepare Your Data">
    Create a Google Sheet with columns: `Store URL`, `Store Owner Email`, `Store Name`
  </Step>
  <Step title="Read from Sheet">
    Use n8n's Google Sheets node to read all stores
  </Step>
  <Step title="Loop Through Stores">
    Use "Split in Batches" node to process each store one at a time
  </Step>
  <Step title="For Each Store">
    1. Import brand: `POST /v1/projects/import`
    2. Connect Shopify: `POST /v1/shopify/connect`
    3. Generate email: `POST /v1/projects/emails/generate`
    4. Send test email: `POST /v1/emails/test/send`
  </Step>
</Steps>

<Accordion title="Shopify Multi-Store Workflow JSON">
```json
{
  "name": "Migma: Shopify Multi-Store",
  "nodes": [
    {
      "parameters": {
        "documentId": "YOUR_GOOGLE_SHEET_ID",
        "sheetName": "Sheet1",
        "options": {}
      },
      "id": "read-sheet",
      "name": "Read Stores",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 3,
      "position": [250, 300],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_GOOGLE_CREDENTIAL_ID",
          "name": "Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 1,
        "options": {}
      },
      "id": "loop",
      "name": "Loop Stores",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [450, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.migma.ai/v1/projects/import",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"urls\": [\"{{ $json['Store URL'] }}\"]}",
        "options": {}
      },
      "id": "import-store",
      "name": "Import Store",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [650, 300],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    },
    {
      "parameters": {
        "amount": 10,
        "unit": "seconds"
      },
      "id": "wait",
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1,
      "position": [850, 300],
      "webhookId": "wait-webhook"
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=https://api.migma.ai/v1/projects/import/{{ $json.data.projectId }}/status",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "options": {}
      },
      "id": "check-status",
      "name": "Check Status",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1050, 300],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.data.status }}",
              "operation": "equals",
              "value2": "active"
            }
          ]
        }
      },
      "id": "is-ready",
      "name": "Is Ready?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1250, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.migma.ai/v1/shopify/connect",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"projectId\": \"{{ $json.data.projectId }}\", \"shopifyStoreUrl\": \"{{ $('Loop Stores').item.json['Store URL'] }}\"}",
        "options": {}
      },
      "id": "connect-shopify",
      "name": "Connect Shopify",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1450, 200],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.migma.ai/v1/projects/emails/generate",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"projectId\": \"{{ $json.data.projectId }}\", \"prompt\": \"Create a welcome email\", \"webMode\": true}",
        "options": {}
      },
      "id": "generate-email",
      "name": "Generate Email",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1650, 200],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    },
    {
      "parameters": {
        "amount": 5,
        "unit": "seconds"
      },
      "id": "wait-gen",
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1,
      "position": [1850, 200],
      "webhookId": "wait-webhook-gen"
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=https://api.migma.ai/v1/projects/emails/{{ $json.data.conversationId }}/status",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "options": {}
      },
      "id": "check-gen",
      "name": "Check Generation",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [2050, 200],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.data.status }}",
              "operation": "equals",
              "value2": "completed"
            }
          ]
        }
      },
      "id": "is-gen-ready",
      "name": "Is Ready?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [2250, 200]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.migma.ai/v1/emails/test/send",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"conversationId\": \"{{ $json.data.conversationId }}\", \"to\": \"{{ $('Loop Stores').item.json['Store Owner Email'] }}\"}",
        "options": {}
      },
      "id": "send-email",
      "name": "Send Test Email",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [2450, 100],
      "credentials": {
        "httpBearerAuth": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Migma API"
        }
      }
    }
  ],
  "connections": {
    "Read Stores": {
      "main": [[{ "node": "Loop Stores", "type": "main", "index": 0 }]]
    },
    "Loop Stores": {
      "main": [[{ "node": "Import Store", "type": "main", "index": 0 }]]
    },
    "Import Store": {
      "main": [[{ "node": "Wait", "type": "main", "index": 0 }]]
    },
    "Wait": {
      "main": [[{ "node": "Check Status", "type": "main", "index": 0 }]]
    },
    "Check Status": {
      "main": [[{ "node": "Is Ready?", "type": "main", "index": 0 }]]
    },
    "Is Ready?": {
      "main": [
        [{ "node": "Connect Shopify", "type": "main", "index": 0 }],
        [{ "node": "Wait", "type": "main", "index": 0 }]
      ]
    },
    "Connect Shopify": {
      "main": [[{ "node": "Generate Email", "type": "main", "index": 0 }]]
    },
    "Generate Email": {
      "main": [[{ "node": "Wait", "type": "main", "index": 0 }]]
    },
    "Check Generation": {
      "main": [[{ "node": "Is Ready?", "type": "main", "index": 0 }]]
    },
    "Is Ready?": {
      "main": [
        [{ "node": "Send Test Email", "type": "main", "index": 0 }],
        [{ "node": "Wait", "type": "main", "index": 0 }]
      ]
    },
    "Send Test Email": {
      "main": [[{ "node": "Loop Stores", "type": "main", "index": 0 }]]
    }
  }
}
```
</Accordion>

<Info>
  **Note:** To send test emails, make sure your API key has the `EMAIL_SEND` permission enabled in Migma Settings → API Integration.
</Info>

### Using Webhooks Instead of Polling

For better performance, use [Migma webhooks](/webhooks) instead of wait/check loops:

1. Add a **Webhook** node in n8n and copy the webhook URL
2. In Migma Settings → API Integration → Webhooks, create a webhook
3. Subscribe to events: `project.import.completed` and `email.generation.completed`
4. Your n8n workflow will be triggered automatically when events occur

## Tips

<AccordionGroup>
  <Accordion title="Passing Data Between Nodes" icon="arrow-right">
    Use n8n expressions to reference previous node data:
    - `{{ $json.data.projectId }}` - Access projectId from current node
    - `{{ $('Import Brand').item.json.data.projectId }}` - Access data from specific node
  </Accordion>

  <Accordion title="Handling Errors" icon="triangle-exclamation">
    Add an **Error Trigger** node to catch failures and send alerts or retry logic.
  </Accordion>

  <Accordion title="Batch Processing" icon="layer-group">
    Use **Split in Batches** node to process multiple items from spreadsheets or databases.
  </Accordion>

  <Accordion title="Export Formats" icon="file-export">
    Available export endpoints:
    - `/v1/export/html/{conversationId}` - Standard HTML
    - `/v1/export/klaviyo/{conversationId}` - Klaviyo format
    - `/v1/export/mailchimp/{conversationId}` - Mailchimp format
    - `/v1/export/mjml/{conversationId}` - MJML format
  </Accordion>
</AccordionGroup>

## Need Help?

<CardGroup cols={2}>
  <Card title="API Documentation" icon="book" href="/api-reference/introduction">
    Complete API reference with all endpoints
  </Card>
  <Card title="Webhooks" icon="bolt" href="/webhooks">
    Set up real-time event notifications
  </Card>
  <Card title="n8n Documentation" icon="book" href="https://docs.n8n.io">
    Learn more about n8n
  </Card>
  <Card title="Join Discord" icon="discord" href="https://discord.gg/ZB6c2meCUA">
    Get help from the community
  </Card>
</CardGroup>
